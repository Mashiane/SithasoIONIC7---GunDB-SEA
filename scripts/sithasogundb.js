
/* sithasogundb */
function banano_sithasogundb_modgundb() {var _B;this.putrecursive=function(_xdata,_xpath,_xvalue) {if (_B==null) _B=this;var _prevobj,_items,_itot,_icnt,_strprev,_prtobj,_litem,_no;try {if (is.null(_xpath) || is.undefined(_xpath)) {_xpath="";}if (_xpath=="") { return ;}_prevobj=_xdata;if (_xpath.indexOf(".")==-1) {_prevobj[_xpath]=_xvalue;} else {_items=_xpath.split(".");_itot=_items.length;_icnt=0;_strprev="";_prtobj=null;_litem=_items[_itot-1];for (_icnt=1;_icnt<=_itot-1;_icnt++) {_strprev=_items[_icnt-1];_prtobj=_prevobj[_strprev];if (is.undefined(_prtobj)) {_no={};_prevobj[_strprev]=_no;_prevobj=_prevobj[_strprev];} else {_prevobj=_prtobj;}}_prevobj[_litem]=_xvalue;}} catch(err) {}};this.strparse=function(_delim,_inputstring) {if (_B==null) _B=this;var _nl;_nl=[];_nl.length=0;try {_inputstring=_B.cstr(_inputstring,_B);if (is.null(_inputstring) || is.undefined(_inputstring)) {_inputstring="";}if (_inputstring=="") { return _nl;}if (_inputstring.indexOf(_delim)==-1) {_nl.push(_inputstring);} else {_nl=_inputstring.split(_delim);}return _nl;} catch(err) {return _nl;}};this.cstr=function(_o) {if (_B==null) _B=this;if (is.null(_o) || is.undefined(_o)) {_o="";}if (_o=="null") { return "";}if (_o=="undefined") { return "";}return ""+_o;};this.getrecursive=function(_xdata,_xpath) {if (_B==null) _B=this;var _prevobj,_res,_items,_itot,_icnt,_strprev,_prtobj,_litem;try {_prevobj=_xdata;if (_xpath.indexOf(".")==-1) {_res=_prevobj[_xpath];if (is.undefined(_res)) {_res=null;}return _res;} else {_items=_xpath.split(".");_itot=_items.length;_icnt=0;_strprev="";_prtobj=null;_litem=_items[_itot-1];for (_icnt=1;_icnt<=_itot-1;_icnt++) {_strprev=_items[_icnt-1];_prtobj=_prevobj[_strprev];if (is.undefined(_prtobj)) {return null;} else {_prevobj=_prtobj;}}_res=_prevobj[_litem];if (is.undefined(_res)) {_res=null;}return _res;}} catch(err) {return null;}};this.mvfield=function(_svalue,_iposition,_delimiter) {if (_B==null) _B=this;var _xpos,_mvalues,_tvalues,_sb,_startcnt;if (_svalue.length==0) { return "";}_xpos=_svalue.indexOf(_delimiter);if (_xpos==-1) { return _svalue;}_mvalues=_B.strparse(_delimiter,_svalue,_B);_tvalues=0;_tvalues=_mvalues.length-1;switch ("" + _iposition) {case "" + -1:return _mvalues[_tvalues];case "" + -2:return _mvalues[_tvalues-1];case "" + -3:_sb=new StringBuilder();_sb.init();_sb.isinitialized=true;_startcnt=0;_sb.append(_mvalues[1]);for (_startcnt=2;_startcnt<=_tvalues;_startcnt++) {_sb.append(_delimiter);_sb.append(_mvalues[_startcnt]);}return _sb.toString();default:_iposition=_iposition-1;if (_iposition<=-1) {return _mvalues[_tvalues];}if (_iposition>_tvalues) {return "";}return _mvalues[_iposition];}};}function banano_sithasogundb_sithasogundb() {var _B=this;_B._mcallback={};_B._eventname="";_B._gun=null;_B._peers=[];_B._gunopt={};_B._users= new banano_sithasogundb_sithasogundbcollection();_B.initialize=function(_module,_meventname) {_B._mcallback=_module;_B._eventname=_meventname;_B._peers.length=0;_B._gunopt={};};_B.setlocalstorage=function(_b) {_B._gunopt["localStorage"]=_b;};_B.setradisk=function(_b) {_B._gunopt["radisk"]=_b;};_B.setdbname=function(_s) {_B._gunopt["file"]=_s;};_B.addpeer=function(_peer) {_B._peers.push(_peer);};_B.connect=function() {var _cb;if (_B._peers.length>=0) {_B._gunopt["peers"]=_B._peers;}_B._gun=BANanoExec("Gun", window, _B._gunopt);_B._users.initialize(_B._mcallback,_B._gun,"Users");_cb=function() {if (typeof _B._mcallback[("" + _B._eventname + "_Auth").toLowerCase()]==="function") {return _B._mcallback[("" + _B._eventname + "_Auth").toLowerCase()](_B)};};_B._gun["on"]("auth",_cb);};_B.geterrormessage=function(_response) {var _res;if (("err" in _response)) {_res=_response["err"];return _res;} else {return "";}};_B.get=function(_module,_collname) {var _bolist,_paths,_tpaths,_cpath,_pobject,_npart,_ni,_coll,_gcollection;_bolist=[];_bolist.length=0;_bolist.push(_B._gun);_paths=_banano_sithasogundb_modgundb.strparse(".",_collname);_tpaths=_paths.length-1;_cpath=0;for (_cpath=0;_cpath<=_tpaths;_cpath++) {_pobject=_bolist[_cpath];_npart=_paths[_cpath];_ni=_pobject["get"](_npart);_bolist.push(_ni);_collname=_npart;}_tpaths=_bolist.length-1;_coll=_bolist[_tpaths];_gcollection= new banano_sithasogundb_sithasogundbcollection();_gcollection.initialize(_module,_B._gun,"");_gcollection.linkexisting(_collname,_coll);return _gcollection;};_B.nextid=function() {var _ni;_ni="i"+_B.guidalphaappgun(14,_B);return _ni;};_B.guidalphaappgun=function(_glen) {var _s;_s=BANanoExec("guidAlphaAppGUN", window, _glen);_s=_s.toLowerCase();return _s;};} 
function guidAlphaAppGUN(len) { 
        var buf = [], 
            chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789', 
            charlen = chars.length, 
            length = len || 32; 
             
        for (var i = 0; i < length; i++) { 
            buf[i] = chars.charAt(Math.floor(Math.random() * charlen)); 
        } 
         
        return buf.join(''); 
    } 
function banano_sithasogundb_sithasogundbcollection() {var _B=this;_B._collection=null;_B._stablename="";_B._record={};_B._rowcount=0;_B._lastposition=0;_B._result=[];_B._schema={};_B._primarykey="";_B._displayfield="";_B._singular="";_B._plural="";_B._displayvalue="";_B._wherefield={};_B._ops=[];_B._orderbyl=[];_B._flds=[];_B._db_bool="BOOL";_B._db_int="INT";_B._db_string="STRING";_B._db_real="REAL";_B._db_blob="BLOB";_B._db_float="FLOAT";_B._db_integer="INTEGER";_B._db_text="TEXT";_B._db_double="DOUBLE";_B._combinel=[];_B._mcallback={};_B._g=null;_B.initialize=function(_module,_gun,_collname) {_B._lastposition=-1;_B._g=_gun;_B._mcallback=_module;_B._record={};_B._wherefield={};_B._ops.length=0;_B._orderbyl.length=0;_B._flds.length=0;_B._lastposition=-1;_B._result.length=0;_B._combinel.length=0;_B._primarykey="id";_B.schemaaddtext1("id",_B);_B._stablename=_collname;if (_collname!="") {_B._collection=_gun["get"](_collname);}return _B;};_B.linkexisting=function(_collname,_collexist) {_B._collection=_collexist;_B._stablename=_collname;};_B.get=function(_collname) {var _bolist,_paths,_tpaths,_cpath,_pobject,_npart,_ni,_coll,_gcollection;_bolist=[];_bolist.length=0;_bolist.push(_B._collection);_paths=_banano_sithasogundb_modgundb.strparse(".",_collname);_tpaths=_paths.length-1;_cpath=0;for (_cpath=0;_cpath<=_tpaths;_cpath++) {_pobject=_bolist[_cpath];_npart=_paths[_cpath];_ni=_pobject["get"](_npart);_bolist.push(_ni);_collname=_npart;}_tpaths=_bolist.length-1;_coll=_bolist[_tpaths];_gcollection= new banano_sithasogundb_sithasogundbcollection();_gcollection.initialize(_B._mcallback,_B._g,"");_gcollection.linkexisting(_collname,_coll);return _gcollection;};_B.on=function() {var _data,_id,_cb;_data={};_id="";_cb=function(_data,_id) {if (typeof _B._mcallback[("" + _B._stablename + "_On").toLowerCase()]==="function") {return _B._mcallback[("" + _B._stablename + "_On").toLowerCase()](_data,_id,_B)};};_B._collection["on"](_cb);return _B;};_B.open=function() {var _data,_id,_cb;_data={};_id="";_cb=function(_data,_id) {if (typeof _B._mcallback[("" + _B._stablename + "_open").toLowerCase()]==="function") {return _B._mcallback[("" + _B._stablename + "_open").toLowerCase()](_data,_id,_B)};};_B._collection["open"](_cb);return _B;};_B.load=function() {var _data,_cb;_data={};_cb=function(_data) {if (typeof _B[("LoadedX").toLowerCase()]==="function") {return _B[("LoadedX").toLowerCase()](_data,_B)};};_B._collection["load"](_cb);return _B;};_B.loadedx=function(_data) {var _k,_v;_B._result.length=0;_B._lastposition=-1;var _kKeys = Object.keys(_data);for (var _kindex=0;_kindex<_kKeys.length;_kindex++) {_k=_kKeys[_kindex];_v=_data[_k];if (is.object(_v)) {_v["id"]=_k;}_B._result.push(_v);}_B._rowcount=_B._result.length;(function() {if (typeof _B._mcallback[("" + _B._stablename + "_load").toLowerCase()]==="function") {var CSr = _B._mcallback[("" + _B._stablename + "_load").toLowerCase()](_data,_B);if(CSr!=null) {return CSr}}})();};_B.path=function(_spath) {var _ref,_gcollection,_collname;_ref=_B._collection["path"](_spath);_gcollection= new banano_sithasogundb_sithasogundbcollection();_gcollection.initialize(_B._mcallback,_B._g,"");_collname=_banano_sithasogundb_modgundb.mvfield(_spath,-1,".");_gcollection.linkexisting(_collname,_ref);return _gcollection;};_B.exists=function() {var _key,_cb;_key="";_cb=function(_key) {if (typeof _B._mcallback[("" + _B._stablename + "_exists").toLowerCase()]==="function") {return _B._mcallback[("" + _B._stablename + "_exists").toLowerCase()](_key,_B)};};_B._collection["not"](_cb);return _B;};_B.once=function() {var _data,_id,_cb;_data={};_id="";_cb=function(_data,_id) {if (typeof _B._mcallback[("" + _B._stablename + "_Once").toLowerCase()]==="function") {return _B._mcallback[("" + _B._stablename + "_Once").toLowerCase()](_data,_id,_B)};};_B._collection["once"](_cb);return _B;};_B.foreach=function() {var _ncol,_gcollection;_ncol=_B._collection["map"]();_gcollection= new banano_sithasogundb_sithasogundbcollection();_gcollection.initialize(_B._mcallback,_B._g,"");_gcollection.linkexisting(_B._stablename,_ncol);return _gcollection;};_B.create=function() {var _skey,_bp;_skey=_B._record[_B._primarykey];_bp=_B._collection["get"](_skey)["put"](_B._record)["then"]();return _bp;};_B.putrecord=function() {var _ack,_cb;_ack={};_cb=function(_ack) {if (typeof _B._mcallback[("" + _B._stablename + "_put").toLowerCase()]==="function") {return _B._mcallback[("" + _B._stablename + "_put").toLowerCase()](_ack,_B)};};_B._collection["put"](_B._record,_cb);};_B.off=function() {_B._collection["off"]();};_B.back=function() {_B._collection["back"]();};_B.delete=function() {var _m;_m={};_m["deleted"]=true;return _B.put(_m,_B);};_B.undelete=function() {var _m;_m={};_m["deleted"]=false;return _B.put(_m,_B);};_B.put=function(_rec) {var _ack,_cb,_bo,_sname,_coll;_ack={};_cb=function(_ack) {if (typeof _B._mcallback[("" + _B._stablename + "_put").toLowerCase()]==="function") {return _B._mcallback[("" + _B._stablename + "_put").toLowerCase()](_ack,_B)};};_bo=_rec;_sname=_bo["constructor"]["name"];switch ("" + _sname) {case "" + "banano_sithasogundb_sithasogundbcollection":_coll=_rec;_B._collection["put"](_coll._collection,_cb);return _coll;default:_B._collection["put"](_rec,_cb);return _B;}};_B.unset=function(_rec) {var _ack,_cb,_bo,_sname,_coll;_ack={};_cb=function(_ack) {if (typeof _B._mcallback[("" + _B._stablename + "_unset").toLowerCase()]==="function") {return _B._mcallback[("" + _B._stablename + "_unset").toLowerCase()](_ack,_B)};};_bo=_rec;_sname=_bo["constructor"]["name"];switch ("" + _sname) {case "" + "banano_sithasogundb_sithasogundbcollection":_coll=_rec;_B._collection["unset"](_coll._collection,_cb);return _coll;default:_B._collection["unset"](_rec,_cb);return _B;}};_B.set=function(_rec) {var _ack,_cb,_bo,_sname,_coll;_ack={};_cb=function(_ack) {if (typeof _B._mcallback[("" + _B._stablename + "_set").toLowerCase()]==="function") {return _B._mcallback[("" + _B._stablename + "_set").toLowerCase()](_ack,_B)};};_bo=_rec;_sname=_bo["constructor"]["name"];switch ("" + _sname) {case "" + "banano_sithasogundb_sithasogundbcollection":_coll=_rec;_B._collection["set"](_coll._collection,_cb);return _coll;default:_B._collection["set"](_rec,_cb);return _B;}};_B.schemaaddblob=function(_bools) {var _b;for (var _bindex=0;_bindex<_bools.length;_bindex++) {_b=_bools[_bindex];_B._schema[_b]=_B._db_blob;}return _B;};_B.schemaaddblob1=function(_b) {_B._schema[_b]=_B._db_blob;return _B;};_B.schemaaddboolean=function(_bools) {var _b;for (var _bindex=0;_bindex<_bools.length;_bindex++) {_b=_bools[_bindex];_B._schema[_b]=_B._db_bool;}return _B;};_B.schemaaddboolean1=function(_b) {_B._schema[_b]=_B._db_bool;return _B;};_B.schemaadddouble1=function(_b) {_B._schema[_b]=_B._db_double;return _B;};_B.schemaadddouble=function(_bools) {var _b;for (var _bindex=0;_bindex<_bools.length;_bindex++) {_b=_bools[_bindex];_B._schema[_b]=_B._db_double;}return _B;};_B.schemaaddfloat1=function(_b) {_B._schema[_b]=_B._db_float;return _B;};_B.schemaaddfloat=function(_bools) {var _b;for (var _bindex=0;_bindex<_bools.length;_bindex++) {_b=_bools[_bindex];_B._schema[_b]=_B._db_float;}return _B;};_B.schemaaddtext1=function(_b) {_B._schema[_b]=_B._db_string;return _B;};_B.schemaaddtext=function(_bools) {var _b;for (var _bindex=0;_bindex<_bools.length;_bindex++) {_b=_bools[_bindex];_B._schema[_b]=_B._db_string;}return _B;};_B.schemaaddint1=function(_b) {_B._schema[_b]=_B._db_int;return _B;};_B.schemaaddint=function(_bools) {var _b;for (var _bindex=0;_bindex<_bools.length;_bindex++) {_b=_bools[_bindex];_B._schema[_b]=_B._db_int;}return _B;};_B.setschemafromdatamodel=function(_models) {var _tm,_fldsx,_fm,_fldtype,_fldname;if ((_B._stablename in _models)==false) {throw "SetSchemaFromDataModel." + _B._stablename + " data-model does NOT exist!";return;}_tm=_models[_B._stablename];_B._primarykey=_tm["pk"]===undefined? "":_tm["pk"];_B._schema={};_fldsx=_tm["fields"];for (var _fmindex=0;_fmindex<_fldsx.length;_fmindex++) {_fm=_fldsx[_fmindex];_fldtype=_fm["type"];_fldname=_fm["name"];switch ("" + _fldtype) {case "" + "TEXT":case "" + "STRING":_B.schemaaddtext1(_fldname,_B);break;case "" + "BLOB":_B.schemaaddblob1(_fldname,_B);break;case "" + "INT":case "" + "INTEGER":_B.schemaaddint1(_fldname,_B);break;case "" + "DOUBLE":case "" + "REAL":case "" + "FLOAT":_B.schemaadddouble1(_fldname,_B);break;case "" + "BOOL":_B.schemaaddboolean1(_fldname,_B);break;}}};_B.prepare=function() {_B._record={};return _B;};_B.setkey=function(_s) {_B.setfield(_B._primarykey,_s,_B);};_B.setrecord=function(_rec) {var _k,_v;var _kKeys = Object.keys(_rec);for (var _kindex=0;_kindex<_kKeys.length;_kindex++) {_k=_kKeys[_kindex];_v=_rec[_k];_B.setfield(_k,_v,_B);}return _B;};_B.setfield=function(_fldname,_fldvalue) {var _dt;if (_fldname.indexOf(".")) {_banano_sithasogundb_modgundb.putrecursive(_B._record,_fldname,_fldvalue);return _B;}_dt=_B._schema[_fldname];switch ("" + _dt) {case "" + _B._db_bool:_fldvalue=_B.cbool(_fldvalue,_B);break;case "" + _B._db_int:_fldvalue=_B.cint(_fldvalue,_B);break;case "" + _B._db_string:_fldvalue=_B.cstr(_fldvalue,_B);break;case "" + _B._db_real:_fldvalue=_B.cdbl(_fldvalue,_B);break;case "" + _B._db_blob:break;case "" + _B._db_float:_fldvalue=_B.cdbl(_fldvalue,_B);break;case "" + _B._db_integer:_fldvalue=_B.cint(_fldvalue,_B);break;case "" + _B._db_text:_fldvalue=_B.cstr(_fldvalue,_B);break;case "" + _B._db_double:_fldvalue=_B.cdbl(_fldvalue,_B);break;}_B._record[_fldname]=_fldvalue;return _B;};_B.join=function(_delimiter,_lst) {var _i,_sbx,_fld;if (_lst.length==0) { return "";}_i=0;_sbx=new StringBuilder();_fld="";_sbx.init();_sbx.isinitialized=true;_fld=_lst[0];_sbx.append(_fld);for (_i=1;_i<=_lst.length-1;_i++) {_fld=_lst[_i];_sbx.append(_delimiter).append(_fld);}return _sbx.toString();};_B.cstr=function(_o) {if (is.null(_o) || is.undefined(_o)) {_o="";}if (_o=="null") { return "";}if (_o=="undefined") { return "";}return ""+_o;};_B.listofmapsgetproperty=function(_lst,_key) {var _nlist,_rectot,_reccnt,_m,_v;_key=_B.cstr(_key,_B);_nlist=[];_nlist.length=0;_rectot=_lst.length-1;_reccnt=0;for (_reccnt=0;_reccnt<=_rectot;_reccnt++) {_m=_lst[_reccnt];if ((_key in _m)) {_v=_m[_key];_v=_B.cstr(_v,_B);_nlist.push(_v);}}return _nlist;};_B.cdbl=function(_o) {var _out,_nvalue,_nout;_o=_B.val(_o,_B);_out=BANano_nf(BANano_r(_o, 2),0);_nvalue=_B.cstr(_out,_B);_nvalue=_nvalue.split(",").join(".");_nvalue=_B.val(_nvalue,_B);_nout=parseFloat(_nvalue);return _nout;};_B.cint=function(_o) {_o=_B.val(_o,_B);return parseInt(_o);};_B.isnan=function(_obj) {var _res;_res=window["isNaN"](_obj);return _res;};_B.val=function(_value) {var _sout,_mout,_slen,_i;_value=_B.cstr(_value,_B);_value=_value.trim();if (_value=="") {_value="0";}if (_B.isnan(_value,_B)) {_value="0";}try {_sout="";_mout="";_slen=_value.length;_i=0;for (_i=0;_i<=_slen-1;_i++) {_mout=_value.charAt(_i);if (_B.instr("0123456789.-",_mout,_B)!=-1) {_sout=_sout+_mout;}}return _sout;} catch(err) {return _value;}};_B.instr=function(_stext,_sfind) {return _stext.toLowerCase().indexOf(_sfind.toLowerCase());};_B.cbool=function(_v) {var _s;if (is.null(_v) || is.undefined(_v)) {_v=false;}if (typeof _v=="string" || typeof _v=="object") {_s=_v+"";_s=_s.toLowerCase();if (_s=="") { return false;}if (_s=="false") { return false;}if (_s=="true") { return true;}if (_s=="1") { return true;}if (_s=="y") { return true;}if (_s=="0") { return false;}if (_s=="n") { return false;}if (_s=="no") { return false;}if (_s=="yes") { return true;}}return _v;};_B.firstrecord=function() {var _rec;_rec=_B._result[0];return _rec;};_B.nextrow=function() {var _realsize;_B._lastposition=_B._lastposition+1;_realsize=_B._rowcount-1;if (_B._lastposition>_realsize) {return false;} else {_B.setposition(_B._lastposition,_B);return true;}};_B.setposition=function(_pos) {if (_B._result.length>_pos) {_B._record=_B._result[_pos];_B._lastposition=_pos;} else {_B._lastposition=-1;_B._record={};}};_B.getposition=function() {return _B._lastposition;};_B.getint=function(_fld) {var _obj;_fld=_fld.toLowerCase();if (is.undefined(_B._record)) { return 0;}if ((_fld in _B._record)) {_obj=_B._record[_fld]===undefined? 0:_B._record[_fld];_obj=_B.cint(_obj,_B);return _obj;} else {return 0;}};_B.getlong=function(_fld) {return _B.getint(_fld,_B);};_B.getstring=function(_fld) {var _obj;_fld=_fld.toLowerCase();if (is.undefined(_B._record)) { return "";}if ((_fld in _B._record)) {_obj=_B._record[_fld]===undefined? "":_B._record[_fld];_obj=_B.cstr(_obj,_B);return _obj;} else {return "";}};_B.getimage=function(_fld) {var _simage;_simage=_B.getstring(_fld,_B);if (_simage=="") { return "./assets/placeholderimg.jpg";}return _simage;};_B.getboolean=function(_fld) {var _obj;_fld=_fld.toLowerCase();if (is.undefined(_B._record)) { return false;}if ((_fld in _B._record)) {_obj=_B._record[_fld]===undefined? false:_B._record[_fld];_obj=_B.cbool(_obj,_B);return _obj;} else {return false;}};_B.getdouble=function(_fld) {var _obj;_fld=_fld.toLowerCase();if ((_fld in _B._record)) {_obj=_B._record[_fld]===undefined? 0:_B._record[_fld];_obj=_B.cdbl(_obj,_B);return _obj;} else {return 0;}};_B.getrecord=function(_pos) {var _rec;_rec=_B._result[_pos];return _rec;};_B.movefirst=function() {_B.setposition(0,_B);};_B.movelast=function() {_B.setposition(_B._rowcount-1,_B);};_B.moveprevious=function() {_B._lastposition=_B._lastposition-1;if (_B._lastposition<0) {_B._lastposition=0;}_B.setposition(_B._lastposition,_B);};_B.movenext=function() {_B._lastposition=_B._lastposition+1;if (_B._lastposition>_B._rowcount) {_B._lastposition=_B._rowcount-1;}_B.setposition(_B._lastposition,_B);};_B.remdelim=function(_svalue,_delim) {var _sw,_ldelim,_nvalue;_sw=_svalue.endsWith(_delim);if (_sw) {_ldelim=_delim.length;_nvalue=_svalue;_sw=_nvalue.endsWith(_delim);if (_sw) {_nvalue=_nvalue.substring(0,_nvalue.length-_ldelim);}return _nvalue;} else {return _svalue;}};_B.movestart=function() {_B._lastposition=-1;};}function banano_sithasogundb_sithasogundbuser() {var _B=this;_B._user=null;_B._alias="";_B._passphrase="";_B._g=null;_B._mcallback={};_B._mevent="";_B._pub="";_B._epub="";_B._priv="";_B._epriv="";_B._soul="";_B._users= new banano_sithasogundb_sithasogundbcollection();_B._pair={};_B.initialize=function(_module,_eventname,_gun) {_B._mcallback=_module;_B._mevent=_eventname;_B._g=_gun._gun;_B._user=_B._g["user"]();_B._users=_gun.get(_B._mcallback,"Users");_B._pub="";_B._epub="";_B._priv="";_B._epriv="";_B._soul="";_B._pair={};return _B;};_B.savetosession=function() {var _useropt;_useropt={};_useropt["sessionStorage"]=true;_B._user["recall"](_useropt);return _B;};_B.subscribetoalias=function() {var _v,_cb;_v={};_cb=function(_v) {if (typeof _B._mcallback[("" + _B._mevent + "_User_OnAlias").toLowerCase()]==="function") {return _B._mcallback[("" + _B._mevent + "_User_OnAlias").toLowerCase()](_v,_B)};};_B._user["get"]("alias")["on"](_cb);};_B.setfirstname=function(_fn) {_B.myspace(_B).get("profile").get("firstname").put(_fn);};_B.setlastname=function(_fn) {_B.myspace(_B).get("profile").get("lastname").put(_fn);};_B.setemail=function(_fn) {_B.myspace(_B).get("profile").get("email").put(_fn);};_B.load=function() {var _ref,_data,_cb;_ref=_B._g["get"]("~" + _B._pub + "");_data={};_cb=function(_data) {if (typeof _B._mcallback[("" + _B._mevent + "_user_load").toLowerCase()]==="function") {return _B._mcallback[("" + _B._mevent + "_user_load").toLowerCase()](_data,_B)};};_ref["load"](_cb);};_B.open=function() {var _ref,_data,_cb;_ref=_B._g["get"]("~" + _B._pub + "");_data={};_cb=function(_data) {if (typeof _B._mcallback[("" + _B._mevent + "_user_open").toLowerCase()]==="function") {return _B._mcallback[("" + _B._mevent + "_user_open").toLowerCase()](_data,_B)};};_ref["open"](_cb);};_B.create=function(_a,_p) {var _ack,_cb;_B._alias=_a;_B._passphrase=_p;_B._pair={};if (_B._alias=="" || _B._passphrase=="") { return ;}_ack={};_cb=function(_ack) {if (typeof _B[("CreateX").toLowerCase()]==="function") {return _B[("CreateX").toLowerCase()](_ack,_B)};};_B._user["create"](_B._alias,_B._passphrase,_cb);};_B.createx=function(_ack) {var _err,_nuser,_methodname;_err=_B.geterrormessage(_ack,_B);if (_err!="") {(function() {if (typeof _B._mcallback[("" + _B._mevent + "_user_error").toLowerCase()]==="function") {var CSr = _B._mcallback[("" + _B._mevent + "_user_error").toLowerCase()](_err,_B);if(CSr!=null) {return CSr}}})();return;}_B._pub=_ack["pub"];_nuser={};_nuser["alias"]=_B._alias;_nuser["pub"]=_B._pub;_B._users.get(_B._alias).put(_nuser);_methodname="" + _B._mevent + "_user_create";(function() {if (typeof _B._mcallback[(_methodname).toLowerCase()]==="function") {var CSr = _B._mcallback[(_methodname).toLowerCase()](_nuser,_B);if(CSr!=null) {return CSr}}})();};_B.geterrormessage=function(_response) {var _res;if (("err" in _response)) {_res=_response["err"];return _res;} else {return "";}};_B.getpublickeybyalias=async function(_salias) {var _otheralias,_sout;try {_otheralias=await _B._g["get"]("~@" + _salias + "")["once"]()["then"]();_sout="";if (is.undefined(_otheralias)==false) {delete _otheralias["_"];_sout=banano_getB4JKeyAt(_otheralias,0);_sout=_sout.split("~").join("");return _sout;} else {return "";}} catch(err) {return "";}};_B.readbypubkey=function(_pubkey) {var _ack,_cb;_pubkey=_pubkey.split("~").join("");_ack={};_cb=function(_ack) {if (typeof _B._mcallback[("" + _B._mevent + "_user_ReadByPubKey").toLowerCase()]==="function") {return _B._mcallback[("" + _B._mevent + "_user_ReadByPubKey").toLowerCase()](_ack,_B)};};_B._g["user"](_pubkey)["once"](_cb);};_B.aliasbypubkey=async function(_pubkey) {var _otheralias;try {_pubkey=_pubkey.split("~").join("");_otheralias=await _B._g["user"](_pubkey)["get"]("alias")["then"]();return _otheralias;} catch(err) {return "";}};_B.issignedin=function() {var _b;_b=_B._user["is"];if (is.undefined(_b)) { return false;}return true;};_B.auth=function(_a,_p) {var _ack,_cb;_B._alias=_a;_B._passphrase=_p;if (_B._alias=="" || _B._passphrase=="") { return ;}_ack={};_cb=function(_ack) {if (typeof _B[("AuthX").toLowerCase()]==="function") {return _B[("AuthX").toLowerCase()](_ack,_B)};};_B._user["auth"](_B._alias,_B._passphrase,_cb);};_B.authx=function(_ack) {var _err,_methodname;_err=_B.geterrormessage(_ack,_B);if (_err!="") {(function() {if (typeof _B._mcallback[("" + _B._mevent + "_user_error").toLowerCase()]==="function") {var CSr = _B._mcallback[("" + _B._mevent + "_user_error").toLowerCase()](_err,_B);if(CSr!=null) {return CSr}}})();return;}_B._pair=_ack["sea"];_B._priv=_banano_sithasogundb_modgundb.getrecursive(_ack,"sea.priv");_B._epriv=_banano_sithasogundb_modgundb.getrecursive(_ack,"sea.epriv");_B._pub=_banano_sithasogundb_modgundb.getrecursive(_ack,"sea.pub");_B._epub=_banano_sithasogundb_modgundb.getrecursive(_ack,"sea.epub");_B._soul=_banano_sithasogundb_modgundb.getrecursive(_ack,"soul");_methodname="" + _B._mevent + "_user_auth";(function() {if (typeof _B._mcallback[(_methodname).toLowerCase()]==="function") {var CSr = _B._mcallback[(_methodname).toLowerCase()](_ack,_B);if(CSr!=null) {return CSr}}})();};_B.subscribetousers=function() {var _data,_id,_cb;_data={};_id="";_cb=function(_data,_id) {if (typeof _B._mcallback[("" + _B._mevent + "_Users_On").toLowerCase()]==="function") {return _B._mcallback[("" + _B._mevent + "_Users_On").toLowerCase()](_data,_id,_B)};};_B._g["get"]("Users")["on"](_cb);};_B.loadusers=function() {var _data,_id,_cb;_data={};_id="";_cb=function(_data,_id) {if (typeof _B._mcallback[("" + _B._mevent + "_Users_Load").toLowerCase()]==="function") {return _B._mcallback[("" + _B._mevent + "_Users_Load").toLowerCase()](_data,_id,_B)};};_B._g["get"]("Users")["load"](_cb);};_B.openusers=function() {var _data,_id,_cb;_data={};_id="";_cb=function(_data,_id) {if (typeof _B._mcallback[("" + _B._mevent + "_Users_Open").toLowerCase()]==="function") {return _B._mcallback[("" + _B._mevent + "_Users_Open").toLowerCase()](_data,_id,_B)};};_B._g["get"]("Users")["open"](_cb);};_B.delete=function() {var _bp;if (_B._alias=="" || _B._passphrase=="") { return null;}_bp=_B._user["delete"](_B._alias,_B._passphrase)["then"]();return _bp;};_B.signout=function() {_B._user["leave"]();};_B.get=function(_spath) {var _ref,_ref1,_gcollection,_collname;_ref=_B._g["get"]("~" + _B._pub + "");_ref1=_ref["path"](_spath);_gcollection= new banano_sithasogundb_sithasogundbcollection();_gcollection.initialize(_B._mcallback,_B._g,"");_collname=_banano_sithasogundb_modgundb.mvfield(_spath,-1,".");_gcollection.linkexisting(_collname,_ref1);return _gcollection;};_B.myspace=function() {var _ref,_gcollection;_ref=_B._g["get"]("~" + _B._pub + "");_gcollection= new banano_sithasogundb_sithasogundbcollection();_gcollection.initialize(_B._mcallback,_B._g,"");_gcollection.linkexisting("user",_ref);return _gcollection;};_B.aliasexists=function(_salias) {var _data,_cb;_data={};_cb=function(_data) {if (typeof _B[("ReadPubX1").toLowerCase()]==="function") {return _B[("ReadPubX1").toLowerCase()](_data,_B)};};_B._g["get"]("~@" + _salias + "")["once"](_cb);};_B.readpubx1=function(_data) {var _sout;_sout="";if (is.undefined(_data)==false) {delete _data["_"];_sout=banano_getB4JKeyAt(_data,0);}if (_sout=="") {(function() {if (typeof _B._mcallback[("" + _B._mevent + "_user_AliasExists").toLowerCase()]==="function") {var CSr = _B._mcallback[("" + _B._mevent + "_user_AliasExists").toLowerCase()](false,_B);if(CSr!=null) {return CSr}}})();} else {(function() {if (typeof _B._mcallback[("" + _B._mevent + "_user_AliasExists").toLowerCase()]==="function") {var CSr = _B._mcallback[("" + _B._mevent + "_user_AliasExists").toLowerCase()](true,_B);if(CSr!=null) {return CSr}}})();}};_B.getpair=function() {_B._pair=_B._user["_"]["sea"];return _B._pair;};_B.encryptdatatoalias=async function(_salias,_msg) {var _mypair,_topub,_sea,_secret,_encrypteddata;_mypair=_B._user["_"]["sea"];_topub=await _B.getpublickeybyalias(_salias,_B);if (_topub=="") { return "";}_sea=window["SEA"];_secret=await _sea["secret"](_topub,_mypair);_encrypteddata=await _sea["encrypt"](_msg,_secret);return _encrypteddata;};_B.decryptfromalias=async function(_salias,_encmsg) {var _mypair,_frompub,_sea,_secret,_decrypteddata;_mypair=_B._user["_"]["sea"];_frompub=await _B.getpublickeybyalias(_salias,_B);if (_frompub=="") { return "";}_sea=window["SEA"];_secret=await _sea["secret"](_frompub,_mypair);_decrypteddata=await _sea["decrypt"](_encmsg,_secret);return _decrypteddata;};_B.encryptdata=async function(_ekey,_msg) {var _sea,_encrypteddata;_sea=window["SEA"];_encrypteddata=await _sea["encrypt"](_msg,_ekey);return _encrypteddata;};}function banano_sithasogundb_sithasogunsea() {var _B=this;_B._sea=null;_B._mcallback={};_B._epriv="";_B._epub="";_B._priv="";_B._pub="";_B.initialize=function(_module) {_B._mcallback=_module;_B._sea=window["SEA"];_B._pub="";_B._epub="";_B._priv="";_B._epriv="";};_B.pair=async function() {var _p;_p=await _B._sea["pair"]();_B._epriv=_p["epriv"];_B._priv=_p["priv"];_B._pub=_p["pub"];_B._epub=_p["pub"];return _p;};_B.encrypt=async function(_target,_p) {var _e;_e=await _B._sea["encrypt"](_target,_p);return _e;};_B.sign=async function(_e,_p) {var _s;_s=await _B._sea["sign"](_e,_p);return _s;};_B.verify=async function(_d,_p) {var _s;_s=await _B._sea["verify"](_d,_p);return _s;};_B.decrypt=async function(_m,_p) {var _s;_s=await _B._sea["decrypt"](_m,_p);return _s;};_B.work=async function(_d,_p) {var _s;_s=await _B._sea["work"](_d,_p);return _s;};_B.secret=async function(_d,_p) {var _s;_s=await _B._sea["secret"](_d,_p);return _s;};_B.certify=async function(_d,_c,_p) {var _s;_s=await _B._sea["certify"](_d,_c,_p);return _s;};}